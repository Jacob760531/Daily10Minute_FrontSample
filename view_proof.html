<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <script src="https://code.jquery.com/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
        <!-- 커스터마이징한 axiosInstace 들고있는 파일 -->
        <script src="/custom_axios.js"></script>
        
    </head>
    <body>
        인증글 상세보기 </br>

        <p id='write_nick'>글쓴사람</p>
        <p id='content'>인증글 내용</p>
        
        <!-- 첨부된 사진들을 보는 목록 -->
        <div id='imgList'>

        </div>

        <!-- 댓글 목록 -->
        <ul id='replyList'>

        </ul>
        

        <script>
            
            // 몇번 인증글을 보러 온건지 주소창 확인
            
            // 주소창의 데이터를 분석해주는 클래스를 변수에 담자.
            let searchParams = new URLSearchParams(window.location.search)
            // 주소창에 proof_id가 뭐라고 적혀있는지 찾아서 저장.
            let proofId = searchParams.get('proof_id')

            // 보러 들어온 인증글 상세 조회 => axios : GET
            axiosInstance.get(`/project_proof/${proofId}`, {
                    params: {
                        // project에선 아직 첨부할 자료가 없어서 비워둔다
                    }
                })
                .then(function (res) {

                    console.log(res)

                    let userNickName = res.data.data.project.user.nick_name

                    $('#write_nick').text(userNickName)

                    let content = res.data.data.project.content
                    
                    $('#content').text(content)

                    res.data.data.project.images.forEach(photo => {
                        
                        console.log(photo)

                        $('#imgList').append(`
                        <img class='proofImgItem' src=${photo.img_url}>
                        `)
                    });

                })
                .catch(function (error) {
                    // 실패시 error의 응답에 담긴 message를 얼럿으로
                    alert(error.response.data.message)
                })

        </script>

    </body>
</html>

